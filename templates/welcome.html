<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>æ¬¢è¿é¡µé¢</title>
    <script>
        function sendFriendRequest(receiverId) {
            fetch('/send_friend_request', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ receiver_id: receiverId })
            })
            .then(response => response.json())
            .then(data => alert(data.message))
            .catch(error => console.error('Error:', error));
        }

        function respondFriendRequest(senderId, action) {
            fetch('/respond_friend_request', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ sender_id: senderId, action: action })
            })
            .then(response => response.json())
            .then(data => {
                alert(data.message);
                location.reload();
            })
            .catch(error => console.error('Error:', error));
        }
    </script>
</head>
<body>
    <h1>æ¬¢è¿, {{ current_user }}ï¼</h1>
    <a href="/logout" style="color: red; font-weight: bold;">ç™»å‡º</a>

    <h2>æ‰€æœ‰ç”¨æˆ·ï¼š</h2>
    <ul>
        {% for user in users %}
            {% if user[0] != current_user_id %}
            <li>
                {{ user[1] }}
                <button onclick="sendFriendRequest({{ user[0] }})">å‘é€å¥½å‹è¯·æ±‚</button>
            </li>
            {% endif %}
        {% endfor %}
    </ul>

    <h2>æ”¶åˆ°çš„å¥½å‹è¯·æ±‚ï¼š</h2>
    <ul>
        {% for request in friend_requests %}
        <li>
            {{ request[1] }} å‘é€äº†å¥½å‹è¯·æ±‚
            <button onclick="respondFriendRequest({{ request[0] }}, 'accept')">æ¥å—</button>
            <button onclick="respondFriendRequest({{ request[0] }}, 'reject')">æ‹’ç»</button>
        </li>
        {% endfor %}
    </ul>

    <h2>ä½ çš„å¥½å‹åˆ—è¡¨ï¼š</h2>
    <ul>
        {% for friend in friends %}
        <li>{{ friend[1] }}</li>
        {% else %}
        <li>ä½ è¿˜æ²¡æœ‰å¥½å‹ã€‚</li>
        {% endfor %}
    </ul>
    <a href="/search_stock">ğŸ” æœç´¢è‚¡ç¥¨</a>
    <a href="/portfolio_watchlist"> go to profolio and watchlist</a>

</body>
</html>
